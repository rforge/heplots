<html><head><title>Three-Dimensional HE Plots</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="Rchm.css">
</head>
<body>

<table width="100%"><tr><td>heplot3d(heplots)</td><td align="right">R Documentation</td></tr></table><object type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="keyword" value="R:   heplot3d">
<param name="keyword" value="R:   heplot3d.mlm">
<param name="keyword" value=" Three-Dimensional HE Plots">
</object>


<h2>Three-Dimensional HE Plots</h2>


<h3>Description</h3>

<p>
This function plots ellipsoids in 3D representing the hypothesis and error
sums-of-squares-and-products matrices for terms and linear hypotheses in a 
multivariate linear model.
</p>


<h3>Usage</h3>

<pre>
heplot3d(mod, ...)

## S3 method for class 'mlm':
heplot3d(mod, terms, hypotheses, term.labels = TRUE, 
    hyp.labels = TRUE, variables = 1:3, error.ellipsoid = !add,
    factor.means = !add, grand.mean = !add, remove.intercept = TRUE, 
    type = c("II", "III", "2", "3"), idata=NULL, idesign=NULL,
        icontrasts=c("contr.sum", "contr.poly"), imatrix=NULL, iterm=NULL,
    manova, size = c("evidence", "effect.size"),
    level = 0.68, alpha = 0.05,  segments = 40, col = palette()[-1], lwd=c(1, 4),
    shade=TRUE, shade.alpha=0.1, wire=c(TRUE,FALSE),
    bg.col = c("white", "black"), fogtype = c("none", "exp2", "linear", "exp"), 
    fov = 30, offset = 0.01, xlab, ylab, zlab, xlim, ylim, zlim, add = FALSE, verbose = FALSE, 
    warn.rank = FALSE, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>mod</code></td>
<td>
a model object of class <code>"mlm"</code>.</td></tr>
<tr valign="top"><td><code>terms</code></td>
<td>
a logical value or character vector of terms in the model 
for which to plot
hypothesis matrices; if missing or <code>TRUE</code>, defaults to all terms; 
if <code>FALSE</code>, no terms are plotted.</td></tr>
<tr valign="top"><td><code>hypotheses</code></td>
<td>
optional list of linear hypotheses for which to plot hypothesis
matrices; hypotheses are specified as for the
<code><a onclick="findlink('car', 'linear.hypothesis.html')" style="text-decoration: underline; color: blue; cursor: hand">linear.hypothesis</a></code> function in the <code>car</code> package;
the list elements can be named, in which case the names are used.</td></tr>
<tr valign="top"><td><code>term.labels</code></td>
<td>
logical value or character vector of names for the terms to be
plotted. If <code>TRUE</code> (the default) the names of the terms are used;
if <code>FALSE</code>, term labels are not plotted.</td></tr>
<tr valign="top"><td><code>hyp.labels</code></td>
<td>
logical value or character vector of names for the hypotheses to
be plotted. If <code>TRUE</code> (the default) the names of components of the list of
hypotheses are used; if <code>FALSE</code>, hypothesis labels are not plotted.</td></tr>
<tr valign="top"><td><code>variables</code></td>
<td>
indices or names of the three response variables to be plotted;
defaults to <code>1:3</code>.</td></tr>
<tr valign="top"><td><code>error.ellipsoid</code></td>
<td>
if <code>TRUE</code>, plot the error ellipsoid; defaults to <code>TRUE</code>,
if the argument <code>add</code> is <code>FALSE</code> (see below).</td></tr>
<tr valign="top"><td><code>factor.means</code></td>
<td>
logical value or character vector of names of 
factors for which the means
are to be plotted, or <code>TRUE</code> or <code>FALSE</code>; defaults to <code>TRUE</code>,
if the argument <code>add</code> is <code>FALSE</code> (see below).</td></tr>
<tr valign="top"><td><code>grand.mean</code></td>
<td>
if <code>TRUE</code>, plot the centroid for all of the data; 
defaults to <code>TRUE</code>,
if the argument <code>add</code> is <code>FALSE</code> (see below).</td></tr>
<tr valign="top"><td><code>remove.intercept</code></td>
<td>
if <code>TRUE</code> (the default), do not plot the 
ellipsoid for the intercept even if it is in the MANOVA table.</td></tr>
<tr valign="top"><td><code>type</code></td>
<td>
``type'' of sum-of-squares-and-products matrices to compute; one of
<code>"II"</code>, <code>"III"</code>, <code>"2"</code>, or <code>"3"</code>, where <code>"II"</code> is
the default (and <code>"2"</code> is a synomym).</td></tr>
<tr valign="top"><td><code>idata</code></td>
<td>
an optional data frame giving a factor or factors defining the 
intra-subject model for multivariate repeated-measures data. 
See Details of <code><a onclick="findlink('car', 'Anova.html')" style="text-decoration: underline; color: blue; cursor: hand">Anova</a></code> for an explanation of the intra-subject design and for further explanation 
of the other arguments relating to intra-subject factors.</td></tr>
<tr valign="top"><td><code>idesign</code></td>
<td>
a one-sided model formula using the ``data'' in idata and specifying 
the intra-subject design for repeated measure models.</td></tr>
<tr valign="top"><td><code>icontrasts</code></td>
<td>
names of contrast-generating functions to be applied by default 
to factors and ordered factors, respectively, in the within-subject ``data''; 
the contrasts must produce an intra-subject model matrix in which different 
terms are orthogonal. The default is c("contr.sum", "contr.poly").</td></tr>
<tr valign="top"><td><code>imatrix</code></td>
<td>
In lieu of <code>idata</code> and <code>idesign</code>, you can specify the
intra-subject design matrix directly via <code>imatrix</code>, in the form of list of named elements.
Each element gives
the columns of the within-subject model matrix for an intra-subject term to be tested, and must
have as many rows as there are responses; the columns of the within-subject model
matrix for <EM>different</EM> terms must be mutually orthogonal. 
<EM>This functionality
requires <code>car</code> version 2.0 or later.</EM></td></tr>
<tr valign="top"><td><code>iterm</code></td>
<td>
For repeated measures designs, you must specify one intra-subject term
(a character string) to select the SSPE (E) matrix used in the HE plot. 
Hypothesis terms plotted include the <code>iterm</code> effect as well as all interactions
of <code>iterm</code> with <code>terms</code>.</td></tr>
<tr valign="top"><td><code>manova</code></td>
<td>
optional <code>Anova.mlm</code> object for the model; if absent a
MANOVA is computed. Specifying the argument can therefore save 
computation in repeated calls.</td></tr>
<tr valign="top"><td><code>size</code></td>
<td>
how to scale the hypothesis ellipsoid relative to the error
ellipsoid; if <code>"evidence"</code>, the default, the scaling is done so that
a ``significant'' hypothesis elliposid extends outside of the error
ellipsoid; if <code>"effect.size"</code>, the hypothesis ellipsoid is on the same
scale as the error ellipsoid.</td></tr>
<tr valign="top"><td><code>level</code></td>
<td>
equivalent coverage of ellipsoid for normally-distributed
errors, defaults to <code>0.68</code>.</td></tr>
<tr valign="top"><td><code>alpha</code></td>
<td>
signficance level for Roy's greatest-root test statistic; if
<code>size="evidence"</code>, then the
hypothesis ellipsoid is scaled so that it just touches the error ellipsoid at the
specified alpha level; a larger hypothesis elllipsoid therefore indicates
statistical significance; defaults to <code>0.05</code>.</td></tr>
<tr valign="top"><td><code>segments</code></td>
<td>
number of segments composing each elliposid; defaults to
<code>40</code>.</td></tr>
<tr valign="top"><td><code>col</code></td>
<td>
a colour or vector of colours to use in plotting ellipsoids; the first
colour is used for the error ellipsoid; the remaining colours &mdash; recycled
as necessary &mdash; are used for the hypothesis ellipsoids; 
a single colour can be given, in which case it is used for all ellipsoids. 
Defaults to the current colour palette, less its first element.</td></tr>
<tr valign="top"><td><code>lwd</code></td>
<td>
a two-element vector giving the line width for drawing ellipsoids
(including those that degenerate to an ellipse) and
for drawing ellipsoids that degenerate to a line segment. The default
is <code>c(1, 4)</code>.</td></tr>
<tr valign="top"><td><code>shade</code></td>
<td>
a logical scalar or vector, indicating whether the ellipsoids should be
rendered with <code><a onclick="findlink('rgl', 'shade3d.html')" style="text-decoration: underline; color: blue; cursor: hand">shade3d</a></code>. Works like <code>col</code>,  except that <code>FALSE</code>
is used for any 1 df degenerate ellipsoid.</td></tr>
<tr valign="top"><td><code>shade.alpha</code></td>
<td>
a numeric value in the range [0,1], or a vector of such values, giving
the alpha transparency for ellipsoids rendered with <code>shade=TRUE</code>.</td></tr>
<tr valign="top"><td><code>wire</code></td>
<td>
a logical scalar or vector, indicating whether the ellipsoids should be
rendered with <code><a onclick="findlink('rgl', 'wire3d.html')" style="text-decoration: underline; color: blue; cursor: hand">wire3d</a></code>. Works like <code>col</code>, except that <code>TRUE</code>
is used for any 1 df degenerate ellipsoid.</td></tr>
<tr valign="top"><td><code>bg.col</code></td>
<td>
background colour, <code>"white"</code> or <code>"black"</code>, defaulting
to <code>"white"</code>.</td></tr>
<tr valign="top"><td><code>fogtype</code></td>
<td>
type of ``fog'' to use for depth-cueing; the default is 
<code>"none"</code>. See <code><a onclick="findlink('rgl', 'bg.html')" style="text-decoration: underline; color: blue; cursor: hand">bg</a></code>.</td></tr>
<tr valign="top"><td><code>fov</code></td>
<td>
field of view angle; controls perspective. 
See <code><a onclick="findlink('rgl', 'viewpoint.html')" style="text-decoration: underline; color: blue; cursor: hand">viewpoint</a></code>.</td></tr>
<tr valign="top"><td><code>offset</code></td>
<td>
proportion of axes to off set labels; defaults to
<code>0.01</code>.</td></tr>
<tr valign="top"><td><code>xlab</code></td>
<td>
x-axis label; defaults to name of the x variable.</td></tr>
<tr valign="top"><td><code>ylab</code></td>
<td>
y-axis label; defaults to name of the y variable.</td></tr>
<tr valign="top"><td><code>zlab</code></td>
<td>
z-axis label; defaults to name of the z variable.</td></tr>
<tr valign="top"><td><code>xlim</code></td>
<td>
x-axis limits; if absent, will be computed from the data.</td></tr>
<tr valign="top"><td><code>ylim</code></td>
<td>
y-axis limits; if absent, will be computed from the data.</td></tr>
<tr valign="top"><td><code>zlim</code></td>
<td>
z-axis limits; if absent, will be computed from the data.</td></tr>
<tr valign="top"><td><code>add</code></td>
<td>
if <code>TRUE</code>, add to the current plot; the default is <code>FALSE</code>.
If <code>TRUE</code>, the error ellipsoid is neither plotted nor returned in the output object.</td></tr>
<tr valign="top"><td><code>verbose</code></td>
<td>
if <code>TRUE</code>, print the MANOVA table and details of hypothesis
tests; the default is <code>FALSE</code>.</td></tr>
<tr valign="top"><td><code>warn.rank</code></td>
<td>
if <code>TRUE</code>, do not suppress warnings about the rank of the
hypothesis matrix when the ellipsoid collapses to an ellipse or line; 
the default is <code>FALSE</code>.</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
arguments passed from generic.</td></tr>
</table>

<h3>Details</h3>

<p>
When the H matrix for a term has rank &lt; 3, the ellipsoid collapses to an 
ellipse (rank(H)=2) or a line (rank(H)=1). 
</p>
<p>
Rotating the plot can be particularly revealing, showing views in which H variation
is particularly large or small in relation to E variation.  See <code><a onclick="findlink('rgl', 'play3d.html')" style="text-decoration: underline; color: blue; cursor: hand">play3d</a></code>
and <code><a onclick="findlink('rgl', 'movie3d.html')" style="text-decoration: underline; color: blue; cursor: hand">movie3d</a></code> for details on creating animations.
</p>
<p>
The arguments <code>xlim</code>, <code>ylim</code>, and <code>zlim</code> can be used to expand the bounding
box of the axes, but cannot decrease it.
</p>


<h3>Value</h3>

<p>
<code>heplot3d</code> invisibly returns a list containing the bounding boxes of the error (E)
ellipsoid and for each term or linear hypothesis specified in the call.
Each of these is a 2 x 3 matrix with rownames "min" and "max" and colnames
corresponding to the variables plotted. An additional component, <code>center</code>,
contains the coordinates of the centroid in the plot.
<br>
The function also leaves an object named
<code>.frame</code> in the global environment, containing the rgl object IDs for
the axes, axis labels, and bounding box; these are deleted and the axes, etc.
redrawn if the plot is added to.</p>

<h3>References</h3>

<p>
Friendly, M. (2006).
Data Ellipses, HE Plots and Reduced-Rank Displays for Multivariate Linear 
Models: SAS Software and Examples 
<EM>Journal of Statistical Software</EM>, 17(6), 1-42.
<a href="http://www.jstatsoft.org/v17/i06/">http://www.jstatsoft.org/v17/i06/</a>
</p>
<p>
Friendly, M. (2007).
HE plots for Multivariate General Linear Models.
<EM>Journal of Computational and Graphical Statistics</EM>, 16(2) 421-444.
<a href="http://www.math.yorku.ca/SCS/Papers/jcgs-heplots.pdf">http://www.math.yorku.ca/SCS/Papers/jcgs-heplots.pdf</a>
</p>


<h3>See Also</h3>

<p>
<code><a onclick="findlink('car', 'Anova.html')" style="text-decoration: underline; color: blue; cursor: hand">Anova</a></code>, <code><a onclick="findlink('car', 'linear.hypothesis.html')" style="text-decoration: underline; color: blue; cursor: hand">linear.hypothesis</a></code>, for details on MANOVA tests and
linear hypotheses
</p>
<p>
<code><a href="heplot.html">heplot</a></code>, <code><a href="pairs.mlm.html">pairs.mlm</a></code>, for other plotting methods for <code>mlm</code> objects
</p>
<p>
<code><a onclick="findlink('rgl', 'rgl-package.html')" style="text-decoration: underline; color: blue; cursor: hand">rgl-package</a></code>, 
</p>
<p>
<code><a onclick="findlink('candisc', 'heplot3d.candisc.html')" style="text-decoration: underline; color: blue; cursor: hand">heplot3d.candisc</a></code> for 3D HE plots in canonical space.
</p>


<h3>Examples</h3>

<pre>
# Soils data, from car package
soils.mod &lt;- lm(cbind(pH,N,Dens,P,Ca,Mg,K,Na,Conduc) ~ Block + Contour*Depth, data=Soils)
Anova(soils.mod)

heplot(soils.mod, variables=c("Ca", "Mg"))
pairs(soils.mod, terms="Depth", variables=c("pH", "N", "P", "Ca", "Mg"))

heplot3d(soils.mod, variables=c("Mg", "Ca", "Na"))

# Plastic data
plastic.mod &lt;- lm(cbind(tear, gloss, opacity) ~ rate*additive, data=Plastic)
heplot3d(plastic.mod)
</pre>

<script Language="JScript">
function findlink(pkg, fn) {
var Y, link;
Y = location.href.lastIndexOf("\\") + 1;
link = location.href.substring(0, Y);
link = link + "../../" + pkg + "/chtml/" + pkg + ".chm::/" + fn;
location.href = link;
}
</script>


<hr><div align="center">[Package <em>heplots</em> version 0.9-1 <a href="00Index.html">Index</a>]</div>

</body></html>
