<html><head><title>Two-Dimensional HE Plots</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="Rchm.css">
</head>
<body>

<table width="100%"><tr><td>heplot(heplots)</td><td align="right">R Documentation</td></tr></table><object type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="keyword" value="R:   heplot">
<param name="keyword" value="R:   heplot.mlm">
<param name="keyword" value=" Two-Dimensional HE Plots">
</object>


<h2>Two-Dimensional HE Plots</h2>


<h3>Description</h3>

<p>
This function plots ellipses representing the hypothesis and error
sums-of-squares-and-products matrices for terms and linear hypotheses in a 
multivariate linear model.  These include MANOVA models (all explanatory
variables are factors), multivariate regression (all quantitative predictors),
MANCOVA models, homogeneity of regression, as well as repeated measures
designs treated from a multivariate perspective.
</p>


<h3>Usage</h3>

<pre>
heplot(mod, ...)

## S3 method for class 'mlm':
heplot(mod, terms, hypotheses, term.labels = TRUE,
    hyp.labels = TRUE, variables = 1:2, error.ellipse = !add, 
    factor.means = !add, grand.mean = !add, remove.intercept = TRUE,
    type = c("II", "III", "2", "3"), idata=NULL, idesign=NULL,
        icontrasts=c("contr.sum", "contr.poly"), imatrix=NULL, iterm=NULL, markH0=!is.null(iterm),
    manova, size = c("evidence", "effect.size"),
    level = 0.68, alpha = 0.05, segments = 40, center.pch = "+", center.cex=2,
    col = palette()[-1], 
    lty = 2:1, lwd = 1:2, xlab, ylab, main = "", xlim, ylim, axes=TRUE, offset.axes, 
    add = FALSE, verbose = FALSE, warn.rank = FALSE, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>mod</code></td>
<td>
a model object of class <code>"mlm"</code>.</td></tr>
<tr valign="top"><td><code>terms</code></td>
<td>
a logical value or character vector of terms in the model 
for which to plot
hypothesis matrices; if missing or <code>TRUE</code>, defaults to all terms; 
if <code>FALSE</code>, no terms are plotted.</td></tr>
<tr valign="top"><td><code>hypotheses</code></td>
<td>
optional list of linear hypotheses for which to plot hypothesis
matrices; hypotheses are specified as for the
<code><a onclick="findlink('car', 'linear.hypothesis.html')" style="text-decoration: underline; color: blue; cursor: hand">linear.hypothesis</a></code> function in the <code>car</code> package;
the list elements can be named, in which case the names are used.</td></tr>
<tr valign="top"><td><code>term.labels</code></td>
<td>
logical value or character vector of names for the terms to be
plotted. If <code>TRUE</code> (the default) the names of the terms are used;
if <code>FALSE</code>, term labels are not plotted.</td></tr>
<tr valign="top"><td><code>hyp.labels</code></td>
<td>
logical value or character vector of names for the hypotheses to
be plotted. If <code>TRUE</code> (the default) the names of components of the list of
hypotheses are used; if <code>FALSE</code>, hypothesis labels are not plotted.</td></tr>
<tr valign="top"><td><code>variables</code></td>
<td>
indices or names of the two response variables to be plotted;
defaults to <code>1:2</code>.</td></tr>
<tr valign="top"><td><code>error.ellipse</code></td>
<td>
if <code>TRUE</code>, plot the error ellipse; defaults to <code>TRUE</code>,
if the argument <code>add</code> is <code>FALSE</code> (see below).</td></tr>
<tr valign="top"><td><code>factor.means</code></td>
<td>
logical value or character vector of names of 
factors for which the means
are to be plotted, or <code>TRUE</code> or <code>FALSE</code>; defaults to <code>TRUE</code>,
if the argument <code>add</code> is <code>FALSE</code> (see below).</td></tr>
<tr valign="top"><td><code>grand.mean</code></td>
<td>
if <code>TRUE</code>, plot the centroid for all of the data; 
defaults to <code>TRUE</code>,
if the argument <code>add</code> is <code>FALSE</code> (see below).</td></tr>
<tr valign="top"><td><code>remove.intercept</code></td>
<td>
if <code>TRUE</code> (the default), do not plot the 
ellipse for the intercept even if it is in the MANOVA table.</td></tr>
<tr valign="top"><td><code>type</code></td>
<td>
``type'' of sum-of-squares-and-products matrices to compute; one of
<code>"II"</code>, <code>"III"</code>, <code>"2"</code>, or <code>"3"</code>, where <code>"II"</code> is
the default (and <code>"2"</code> is a synomym).</td></tr>
<tr valign="top"><td><code>idata</code></td>
<td>
an optional data frame giving a factor or factors defining the 
intra-subject model for multivariate repeated-measures data. 
See Details of <code><a onclick="findlink('car', 'Anova.html')" style="text-decoration: underline; color: blue; cursor: hand">Anova</a></code> for an explanation of the intra-subject design and for further explanation 
of the other arguments relating to intra-subject factors.</td></tr>
<tr valign="top"><td><code>idesign</code></td>
<td>
a one-sided model formula using the ``data'' in idata and specifying 
the intra-subject design for repeated measure models.</td></tr>
<tr valign="top"><td><code>icontrasts</code></td>
<td>
names of contrast-generating functions to be applied by default 
to factors and ordered factors, respectively, in the within-subject ``data''; 
the contrasts must produce an intra-subject model matrix in which different 
terms are orthogonal. The default is c("contr.sum", "contr.poly").</td></tr>
<tr valign="top"><td><code>imatrix</code></td>
<td>
In lieu of <code>idata</code> and <code>idesign</code>, you can specify the
intra-subject design matrix directly via <code>imatrix</code>, in the form of list of named elements.
Each element gives
the columns of the within-subject model matrix for an intra-subject term to be tested, and must
have as many rows as there are responses; the columns of the within-subject model
matrix for <EM>different</EM> terms must be mutually orthogonal. 
<EM>This functionality
requires <code>car</code> version 2.0 or later.</EM></td></tr>
<tr valign="top"><td><code>iterm</code></td>
<td>
For repeated measures designs, you must specify one intra-subject term
(a character string) to select the SSPE (E) matrix used in the HE plot. 
Hypothesis terms plotted include the <code>iterm</code> effect as well as all interactions
of <code>iterm</code> with <code>terms</code>.</td></tr>
<tr valign="top"><td><code>markH0</code></td>
<td>
A logical value (or else a list of arguments to <code><a href="mark.H0.html">mark.H0</a></code>) used to
draw cross-hairs and a point indicating the value of a point null hypothesis.
The default is TRUE if <code>iterm</code> is non-NULL.</td></tr>
<tr valign="top"><td><code>manova</code></td>
<td>
optional <code>Anova.mlm</code> object for the model; if absent a
MANOVA is computed. Specifying the argument can therefore save 
computation in repeated calls.</td></tr>
<tr valign="top"><td><code>size</code></td>
<td>
how to scale the hypothesis ellipse relative to the error
ellipse; if <code>"evidence"</code>, the default, the scaling is done so that
a ``significant'' hypothesis ellipse at level <code>alpha</code> extends outside of the error
ellipse; if <code>"effect.size"</code>, the hypothesis ellipse is on the same
scale as the error ellipse.</td></tr>
<tr valign="top"><td><code>level</code></td>
<td>
equivalent coverage of ellipse for normally-distributed
errors, defaults to <code>0.68</code>.</td></tr>
<tr valign="top"><td><code>alpha</code></td>
<td>
signficance level for Roy's greatest-root test statistic; if
<code>size="evidence"</code>, then the
hypothesis ellipse is scaled so that it just touches the error ellipse at the
specified alpha level; a larger hypothesis ellipse therefore indicates
statistical significance; defaults to <code>0.05</code>.</td></tr>
<tr valign="top"><td><code>segments</code></td>
<td>
number of line segments composing each ellipse; defaults to
<code>40</code>.</td></tr>
<tr valign="top"><td><code>center.pch</code></td>
<td>
character to use in plotting the centroid of the data;
defaults to <code>"+"</code>.</td></tr>
<tr valign="top"><td><code>center.cex</code></td>
<td>
size of character to use in plotting the centroid of the data;
defaults to <code>2</code>.</td></tr>
<tr valign="top"><td><code>col</code></td>
<td>
a colour or vector of colours to use in plotting ellipses; the first
colour is used for the error ellipse; the remaining colours &mdash; recycled
as necessary &mdash; are used for the hypothesis ellipses; 
a single colour can be given, in which case it is used for all ellipses. 
Defaults to the current colour palette, less its first element.</td></tr>
<tr valign="top"><td><code>lty</code></td>
<td>
vector of line types to use for plotting the ellipses; the first is
used for the error ellipse, the rest &mdash; possibly recycled &mdash; for
the hypothesis ellipses; a single line type can be given. Defaults to
<code>2:1</code>.</td></tr>
<tr valign="top"><td><code>lwd</code></td>
<td>
vector of line widths to use for plotting the ellipses; the first is
used for the error ellipse, the rest &mdash; possibly recycled &mdash; for
the hypothesis ellipses; a single line width can be given. Defaults to
<code>1:2</code>.</td></tr>
<tr valign="top"><td><code>xlab</code></td>
<td>
x-axis label; defaults to name of the x variable.</td></tr>
<tr valign="top"><td><code>ylab</code></td>
<td>
y-axis label; defaults to name of the y variable.</td></tr>
<tr valign="top"><td><code>main</code></td>
<td>
main plot label; defaults to <code>""</code>.</td></tr>
<tr valign="top"><td><code>xlim</code></td>
<td>
x-axis limits; if absent, will be computed from the data.</td></tr>
<tr valign="top"><td><code>ylim</code></td>
<td>
y-axis limits; if absent, will be computed from the data.</td></tr>
<tr valign="top"><td><code>axes</code></td>
<td>
Whether to draw the x, y axes; defaults to <code>TRUE</code></td></tr>
<tr valign="top"><td><code>offset.axes</code></td>
<td>
proportion to extend the axes in each direction if computed 
from the data; optional.</td></tr>
<tr valign="top"><td><code>add</code></td>
<td>
if <code>TRUE</code>, add to the current plot; the default is <code>FALSE</code>.
If <code>TRUE</code>, the error ellipse is not plotted.</td></tr>
<tr valign="top"><td><code>verbose</code></td>
<td>
if <code>TRUE</code>, print the MANOVA table and details of hypothesis
tests; the default is <code>FALSE</code>.</td></tr>
<tr valign="top"><td><code>warn.rank</code></td>
<td>
if <code>TRUE</code>, do not suppress warnings about the rank of the
hypothesis matrix when the ellipse collapses to a line; the default is
<code>FALSE</code>.</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
arguments to pass down to <code>plot</code>, <code>text</code>, 
and <code>points</code>.</td></tr>
</table>

<h3>Details</h3>

<p>
The <code>heplot</code> function plots a representation of the covariance ellipses
for hypothesized model terms and linear hypotheses (H) and the corresponding
error (E) matrices for two response variables in a multivariate linear model (mlm).
</p>
<p>
The plot helps to visualize the nature and dimensionality
response variation on the two variables jointly
in relation to error variation that is summarized in the various multivariate
test statistics (Wilks' Lambda, Pillai trace, Hotelling-Lawley trace, Roy maximum
root). Roy's maximum root test has a particularly simple visual interpretation,
exploited in the <code>size="evidence"</code> version of the plot. See the description of
argument <code>alpha</code>.
</p>
<p>
For a 1 df hypothesis term (a quantitative regressor, a single contrast or 
parameter test), the H matrix has rank 1 (one non-zero latent root of
<i>H E^{-1}</i>) and the H ellipse collapses to a line. 
</p>
<p>
Typically, you fit a mlm with <code>mymlm &lt;- lm(cbind(y1, y2, y3, ...) ~ modelterms)</code>,
and plot some or all of the <code>modelterms</code> with <code>heplot(mymlm, ...)</code>.
Arbitrary linear hypotheses related to the terms in the model (e.g., contrasts of
an effect) can be included in the plot using the <code>hypotheses</code> argument. 
See <code><a onclick="findlink('car', 'linear.hypothesis.html')" style="text-decoration: underline; color: blue; cursor: hand">linear.hypothesis</a></code> for details.
</p>
<p>
For repeated measure designs, where the response variables correspond to one or
more variates observed under a within-subject design, between-subject effects 
and within-subject effects must be plotted separately, because the error terms 
(E matrices) differ.  When you specify an intra-subject term (<code>iterm</code>),
the analysis and HE plots
amount to analysis of the matrix <B>Y</B> of responses post-multiplied by a matrix 
<B>M</B> determined by the intra-subject design for that term.
</p>
<p>
The related <code><a onclick="findlink('candisc', 'candisc.html')" style="text-decoration: underline; color: blue; cursor: hand">candisc</a></code> package provides functions for 
visualizing a multivariate linear model in a low-dimensional view via a
generalized canonical discriminant analyses.  <code><a onclick="findlink('candisc', 'heplot.candisc.html')" style="text-decoration: underline; color: blue; cursor: hand">heplot.candisc</a></code>
and <code><a onclick="findlink('candisc', 'heplot3d.candisc.html')" style="text-decoration: underline; color: blue; cursor: hand">heplot3d.candisc</a></code> provide a low-rank 2D (or 3D) view of the effects for  
a given term in the space of maximum discrimination.
</p>


<h3>Value</h3>

<p>
The function invisibly returns an object of class <code>"heplot"</code>, with
coordinates for the various hypothesis ellipses and the error ellipse, and
the limits of the horizontal and vertical axes.  These may be useful for
adding additional annotations to the plot, using standard plotting functions.
(No methods for manipulating these objects are currently available.)
<br>
The components are:
</p>
<table summary="R argblock">
<tr valign="top"><td><code>H</code></td>
<td>
a list containing the coordinates of each ellipse for the hypothesis terms</td></tr>
<tr valign="top"><td><code>E</code></td>
<td>
a matrix containing the coordinates for the error ellipse</td></tr>
<tr valign="top"><td><code>center</code></td>
<td>
x,y coordinates of the centroid</td></tr>
<tr valign="top"><td><code>xlim</code></td>
<td>
x-axis limits</td></tr>
<tr valign="top"><td><code>ylim</code></td>
<td>
y-axis limits</td></tr>
</table>

<h3>References</h3>

<p>
Friendly, M. (2006).
Data Ellipses, HE Plots and Reduced-Rank Displays for Multivariate Linear 
Models: SAS Software and Examples 
<EM>Journal of Statistical Software</EM>, <B>17</B>(6), 1&ndash;42.
<a href="http://www.jstatsoft.org/v17/i06/">http://www.jstatsoft.org/v17/i06/</a>
</p>
<p>
Friendly, M. (2007).
HE plots for Multivariate General Linear Models.
<EM>Journal of Computational and Graphical Statistics</EM>, <B>16</B>(2) 421&ndash;444.
<a href="http://www.math.yorku.ca/SCS/Papers/jcgs-heplots.pdf">http://www.math.yorku.ca/SCS/Papers/jcgs-heplots.pdf</a>
</p>


<h3>See Also</h3>

<p>
<code><a onclick="findlink('car', 'Anova.html')" style="text-decoration: underline; color: blue; cursor: hand">Anova</a></code>, <code><a onclick="findlink('car', 'linear.hypothesis.html')" style="text-decoration: underline; color: blue; cursor: hand">linear.hypothesis</a></code> for details on 
testing <code>mlm</code>s.
</p>
<p>
<code><a href="heplot1d.html">heplot1d</a></code>, <code><a href="heplot3d.html">heplot3d</a></code>, <code><a href="pairs.mlm.html">pairs.mlm</a></code>, <code><a href="mark.H0.html">mark.H0</a></code> for other
HE plot functions.
</p>
<p>
<code><a onclick="findlink('candisc', 'candisc.html')" style="text-decoration: underline; color: blue; cursor: hand">candisc</a></code>,   <code><a onclick="findlink('candisc', 'heplot.candisc.html')" style="text-decoration: underline; color: blue; cursor: hand">heplot.candisc</a></code> for views
in canonical space.
</p>


<h3>Examples</h3>

<pre>
## iris data
contrasts(iris$Species)&lt;-matrix(c(0,-1,1, 2, -1, -1), 3,2)
contrasts(iris$Species)

iris.mod &lt;- lm(cbind(Sepal.Length, Sepal.Width, Petal.Length, Petal.Width) ~
Species, data=iris)

hyp &lt;- list("V:V"="Species1","S:VV"="Species2")
heplot(iris.mod, hypotheses=hyp)
# compare with effect-size scaling
heplot(iris.mod, hypotheses=hyp, size="effect", add=TRUE)

hep &lt;-heplot(iris.mod, variables=c(1,3),  hypotheses=hyp)
str(hep)

# all pairs
pairs(iris.mod, hypotheses=hyp, hyp.labels=FALSE)

## Pottery data, from car package
data(Pottery)
pottery.mod &lt;- lm(cbind(Al, Fe, Mg, Ca, Na) ~ Site, data=Pottery)
heplot(pottery.mod)
heplot(pottery.mod, terms=FALSE, add=TRUE, col="blue", 
  hypotheses=list(c("SiteCaldicot = 0", "SiteIsleThorns=0")),
  hyp.labels="Sites Caldicot and Isle Thorns")

## Rohwer data, multivariate multiple regression/ANCOVA
#-- ANCOVA, assuming equal slopes
rohwer.mod &lt;- lm(cbind(SAT, PPVT, Raven) ~ SES + n + s + ns + na + ss, data=Rohwer)
Anova(rohwer.mod)
heplot(rohwer.mod)
# Add ellipse to test all 5 regressors
heplot(rohwer.mod, hypotheses=list("Regr" = c("n", "s", "ns", "na", "ss")))
# View all pairs
pairs(rohwer.mod, hypotheses=list("Regr" = c("n", "s", "ns", "na", "ss")))
# or 3D plot
col &lt;- c("pink", "black", "blue", "cyan", "magenta", "brown", "gray")
heplot3d(rohwer.mod, hypotheses=list("Regr" = c("n", "s", "ns", "na", "ss")), col=col)
</pre>

<script Language="JScript">
function findlink(pkg, fn) {
var Y, link;
Y = location.href.lastIndexOf("\\") + 1;
link = location.href.substring(0, Y);
link = link + "../../" + pkg + "/chtml/" + pkg + ".chm::/" + fn;
location.href = link;
}
</script>


<hr><div align="center">[Package <em>heplots</em> version 0.9-1 <a href="00Index.html">Index</a>]</div>

</body></html>
